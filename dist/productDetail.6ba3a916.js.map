{"mappings":"0qBAAA,IAAAA,EAAAC,EAAA,6DAOA,MAAMC,EAAqBC,SAASC,eAAe,gBAC7CC,EAAoBF,SAASC,eAAe,iBAGlD,IACIE,EADAC,EAAO,GAUXC,eAAeC,IACX,MAAMC,EARV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAKjBO,CAAS,MACrBC,EAASC,EAAAC,IAAIrB,EAAAsB,GAAI,WAAYZ,IAYvC,SAAyBa,GACrBlB,EAAkBmB,MAAMC,gBAAkB,QAAQF,EAAQG,OAAO,OAGjExB,EAAmByB,UAAY,2VA0BqBpB,EAAAqB,6IAO5CL,EAAMM,SAAAC,oEAGcP,EAAAM,SAAKC,oEACZP,EAAQM,SAAAC,0GAKhBC,EAAQC,eAAYT,EAAAU,mCACpCV,EAAAW,0WAWKC,EAAAjC,EAAakC,cAAA,cAEdC,EACGnC,EAAOkC,cAAA,gBAGXD,EAAAG,iBAAA,SAAiB9B,MAAA+B,IAChBA,EAAAC,0HApEDC,CALgB,WAHMrB,EAAAsB,OAAOvB,IACRwB,OAIjBC,GAAIlC,yRC7BZ,SAASmC,EAAeZ,GACpB,OAAO,IAAIa,KAAKC,aAAa,QAAS,CAClCvB,MAAO,WAAYwB,SAAU,MAAOC,sBAAuB,IAC5DC,OAAOjB,+JCHd,IAAAb,EAAAnB,EAAA,SAEAO,eAAe2C,EAAmB7B,EAAI8B,EAAQC,GAC1C,UACUjC,EAAAkC,OAAOlC,EAAAC,IAAIC,EAAI,OAAQ8B,GAAS,CAJ9CC,KAKYA,IACP,MAAMd,GACHgB,QAAQC,IAAIjB,IAIpB/B,eAAeiD,EAAgBnC,EAAI8B,GAC/B,MAAMjC,EAASC,EAAAC,IAAIC,EAAI,OAAQ8B,GAEzBM,SADgBtC,EAAAsB,OAAOvB,IACNwB,OACvB,OAAQe,EAAUA,EAAOL,KAAO","sources":["logic/productDetail.js","logic/utils/index.js","logic/cart.js"],"sourcesContent":["import { db, auth } from \"./importFirebase\"\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { currencyFormat } from \"./utils/index\";\r\nimport { createFirebaseCart, getFirebaseCart } from \"./cart\";\r\n\r\n\r\nconst productInfoSection = document.getElementById(\"detail__info\");\r\nconst productImgSection = document.getElementById(\"detail__photo\");\r\n\r\n\r\nlet cart = [];\r\nlet userLogged = undefined;\r\n\r\nfunction getParam(param){\r\n    const url = window.location.search;\r\n    const searchParams = new URLSearchParams(url);\r\n    const productId = searchParams.get(param);\r\n    return productId;\r\n}\r\n\r\nasync function getProduct() {\r\n    const productId = getParam(\"id\");\r\n    const docRef = doc(db, \"products\", productId);\r\n    const docSnap = await getDoc(docRef);\r\n    const data = docSnap.data();\r\n\r\n    const product = {\r\n        ... data,\r\n        id: productId,\r\n    }\r\n\r\n    renderProducts(product);\r\n}\r\n\r\nfunction renderProducts (product) {\r\n    productImgSection.style.backgroundImage = `url(\"${product.images[1]}\")`;\r\n    \r\n\r\n    productInfoSection.innerHTML = `\r\n            <div class=\"detail__header\">\r\n                <img src=\"https://firebasestorage.googleapis.com/v0/b/maog-shop.appspot.com/o/images%2Flogo-black.png?alt=media&token=0baf1284-d5f6-4f98-9d0e-0e89dde59004\" width=\"45px\" alt=\"logo\">\r\n                <li class=\"menu__list__black\"><a href=\"./mycart.html\">Cart</a> <div id=\"cartCounter\"> ${cart.length}</div></li>\r\n            </div>\r\n\r\n            <div class=\"detail__text visbyMedium\">\r\n                <h1 class=\"detail__text__01\">${product.category.toUpperCase()}</h1>\r\n                <h1 class=\"detail__text__02\">${product.category.toUpperCase()}</h1>\r\n                <h1 class=\"detail__text__03\">${product.category.toUpperCase()}</h1>\r\n            </div>\r\n\r\n            <div class= \"detail__info\">\r\n                <h3>${currencyFormat(product.price)}</h3>\r\n                <p>${product.description}</p>\r\n            </div>\r\n\r\n            <div class=\"detail__btn\">\r\n            <img src=\"https://firebasestorage.googleapis.com/v0/b/maog-shop.appspot.com/o/images%2Fcounter.png?alt=media&token=0f9a670c-fa0e-4d11-a8e3-658dda8642fd\" width=\"\" alt=\"contador\">\r\n            <button class=\"btn__cart\">Add to cart</button>\r\n            </div>\r\n    `\r\n\r\n    const addToCartBtn = productInfoSection.querySelector(\".btn__cart\");\r\n    const cartCounter = productInfoSection.querySelector(\"#cartCounter\");\r\n\r\n    addToCartBtn.addEventListener(\"click\", async (e) => {\r\n        e.preventDefault();\r\n        \r\n        cart.push(product);\r\n        addProductToCart(cart);\r\n        \r\n        if (userLogged) {\r\n            await createFirebaseCart(db, userLogged.uid, cart);\r\n        }\r\n\r\n        cartCounter.innerText = cart.length;\r\n        console.log(cart.length);\r\n    });\r\n}\r\n\r\nasync function addProductToCart(cart){\r\n    localStorage.setItem(\"cat\", JSON.stringify(cart));\r\n}\r\n\r\nfunction getMyCart(){\r\n    const myCart = localStorage.getItem(\"cart\");\r\n    return myCart ? JSON.parse(myCart) : []; \r\n}\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n     \r\n      userLogged = user;\r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n\r\n    } else {\r\n        cart = getMyCart();\r\n        \r\n    }\r\n    getProduct(\"id\");\r\n  });\r\n\r\n\r\nexport {\r\n    getMyCart,\r\n    addProductToCart,\r\n    \r\n}\r\n","function currencyFormat(price) {\r\n    return new Intl.NumberFormat(\"es-CO\", {\r\n        style: 'currency', currency: 'COP', maximumFractionDigits: 0\r\n    }).format(price);\r\n}\r\n\r\nexport {\r\n    currencyFormat,\r\n}","import { getDoc, setDoc, doc } from \"firebase/firestore\";\r\n\r\nasync function createFirebaseCart(db, userId, cart) {\r\n    try{\r\n        await setDoc(doc(db, \"cart\", userId), {\r\n            cart});\r\n    }catch(e){\r\n        console.log(e);\r\n    }\r\n}\r\n\r\nasync function getFirebaseCart(db, userId) {\r\n    const docRef = doc(db, \"cart\", userId);\r\n    const docSnap = await getDoc(docRef);\r\n    const result = docSnap.data();\r\n    return (result) ? result.cart : [];\r\n}\r\n\r\nexport {\r\n    getFirebaseCart,\r\n    createFirebaseCart,\r\n}"],"names":["$ijjug","parcelRequire","$e6d76c7556912bae$var$productInfoSection","document","getElementById","$e6d76c7556912bae$var$productImgSection","$e6d76c7556912bae$var$userLogged","$e6d76c7556912bae$var$cart","async","$e6d76c7556912bae$var$getProduct","productId","param","url","window","location","search","URLSearchParams","get","$e6d76c7556912bae$var$getParam","docRef","$etBjH","doc","db","product","style","backgroundImage","images","innerHTML","length","category","toUpperCase","$jVR3t","currencyFormat","price","description","addToCartBtn","querySelector","cartCounter","addEventListener","e","preventDefault","$e6d76c7556912bae$var$renderProducts","getDoc","data","id","$e82c7ed2670b1a29$export$4670d0ed237a9270","Intl","NumberFormat","currency","maximumFractionDigits","format","$fb9ec430e4dec552$export$c4c0f4d338c4705c","userId","cart","setDoc","console","log","$fb9ec430e4dec552$export$a3a310d78d7bbb5b","result"],"version":3,"file":"productDetail.6ba3a916.js.map"}